
const fs = require('fs');
const path = require('path');

const targetFile = 'saja_sohak_data.js';
const filePath = path.join(__dirname, targetFile);

const section7_1Title = "7-1. 수신편: 오륜과 삼강 (인간 사회의 다섯 줄기와 세 기둥)";
const section7_2Title = "7-2. 수신편: 구용과 구사 (품격 있는 몸가짐과 지혜로운 생각)";
const section7_3Title = "7-3. 수신편: 처세와 인과 (지혜로운 삶과 배움의 마무리)";

const rawData7_1 = `
見善從之 (견선종지) 하고,좋은 선행을 보았다면 망설임 없이 본받고
知過必改 (지과필개) 하라,나의 잘못을 깨달았다면 반드시 즉시 고쳐라.
悅人讚者 (열인찬자) 는,남의 칭찬만 달콤하게 즐기는 사람은
百事皆僞 (백사개위) 요,"하는 일마다 겉치레와 거짓이 섞이게 되고,"
厭人責者 (염인책자) 는,남의 따끔한 조언을 듣기 싫어하는 사람은
其行無進 (기행무진) 이니라,그 행실에 결코 더 나은 발전이 없느니라.
元亨利貞 (원형이정) 은,만물이 태어나고 자라 결실을 맺는 것은
天道之常 (천도지상) 이요,"변하지 않는 자연과 하늘의 이치이며,"
仁義禮智 (인의예지) 는,"어짊과 의로움, 예의와 지혜는"
人性之綱 (인성지강) 이니라,사람의 본성을 지탱하는 가장 큰 줄기니라.
父子有親 (부자유친) 하며,부모와 자식 사이에는 깊은 친애함이 있어야 하고
君臣有義 (군신유의) 하며,"리더와 구성원 사이에는 굳건한 의리가 있어야 하며,"
夫婦有別 (부부유별) 하며,남편과 아내는 서로의 역할을 존중하며 분별이 있고
長幼有序 (장유유서) 하며,"어른과 아이 사이에는 삶의 순서와 질서가 있으며,"
朋友有信 (붕우유신) 이니,친구와 친구 사이에는 변치 않는 믿음이 있어야 하니
是非謂五倫 (시위오륜) 이니라,이것을 일컬어 사람이 지켜야 할 다섯 가지 도리라 한다.
君爲臣綱 (군위신강) 이요,리더는 구성원의 모범이 되는 기둥이 되어야 하고
父爲子綱 (부위자강) 이요,"아버지는 자식의 삶을 이끄는 기둥이 되어야 하며,"
夫爲婦綱 (부위부강) 이니,남편은 아내와 가정의 든든한 기둥이 되어야 하니
是謂三綱 (시위삼강) 이니라,이것을 일컬어 사회를 지탱하는 세 가지 큰 기둥이라 한다.
人所以貴 (인소이귀) 는,사람이 만물 중에서 가장 귀하게 여겨지는 까닭은
以其倫綱 (이기윤강) 이니라,바로 이러한 도리와 질서를 지키기 때문이니라.
`;

const rawData7_2 = `
足容必重 (족용필중) 하고,"발걸음은 모름지기 가볍지 않고 진중해야 하며,"
手容必恭 (수용필공) 하라,손의 움직임은 언제나 공손하고 단정해야 한다.
目容必端 (목용필단) 하고,"눈빛은 항상 바르고 곧게 유지해야 하며,"
口容必止 (구용필지) 하라,입 모양은 함부로 놀리지 말고 굳게 다물어야 한다.
聲容必靜 (성용필정) 하고,"목소리는 소란스럽지 않고 고요하고 맑아야 하며,"
頭容必直 (두용필직) 하라,머리 모양은 비뚤어지지 않게 바로 세워야 한다.
氣容必肅 (기용필숙) 하고,"숨쉬기와 기운은 엄숙하고 고르게 다스리며,"
立容必德 (입용필덕) 하라,서 있는 모습은 덕망이 느껴지도록 당당해야 한다.
色容必莊 (색용필장) 하니,"안색은 늘 씩씩하고 장중하게 가꾸어야 하니,"
是曰九容 (시왈구용) 이니라,이것이 바로 몸을 다스리는 아홉 가지 모습이다.
視必思明 (시필사명) 하고,"무언가를 볼 때는 편견 없이 밝게 보려 노력하고,"
聽必思聰 (청필사총) 하라,남의 말을 들을 때는 그 본뜻을 막힘없이 귀담아듣라.
色必思溫 (색필사온) 하고,"표정을 지을 때는 부드럽고 따뜻한 기운을 생각하며,"
貌必思恭 (모필사공) 하라,용모와 태도는 항상 상대에 대한 예의를 먼저 생각하라.
言必思忠 (언필사충) 하고,"말을 뱉을 때는 진심과 정성이 담겼는지 생각하고,"
事必思敬 (사필사경) 하라,일을 처리할 때는 공경하고 조심스러운 태도를 유지하라.
疑必思問 (의필사문) 하고,"의문이 생기면 겸손하게 묻고 배우는 것을 생각하며,"
忿必思難 (분필사난) 하라,화가 치밀 때는 이로 인해 닥칠 어려움을 미리 생각하라.
見得思義 (견득사의) 하니,"이득을 보게 되면 그것이 정의에 맞는지 생각해야 하니,"
提曰九思 (제왈구사) 니라,이것이 바로 마음을 다스리는 아홉 가지 생각이다.
`;

const rawData7_3 = `
非禮勿視 (비례물시) 하고,예의에 어긋나는 것이라면 아예 보지를 말고
非禮勿聽 (비례물청) 하라,도리에 어긋나는 소문이라면 아예 듣지를 말라.
非禮勿言 (비례물언) 하고,예의가 아닌 말이라면 입 밖으로 꺼내지 말고
非禮勿動 (비례물동) 하라,도리가 아닌 일이라면 결코 움직이지 말아야 한다.
行必正直 (행필정직) 하고,행동은 반드시 바르고 곧게 해야 하며
言則信實 (언즉신실) 하라,말은 언제나 믿음직하고 진실해야 한다.
容貌端正 (용모단정) 하고,겉모습은 항상 단정하고 깨끗하게 가꾸며
衣冠整齊 (의관정제) 하라,옷차림은 흐트러짐 없이 가지런히 하라.
居處必恭 (거처필공) 하고,머무는 곳에서는 항상 공손한 자세를 유지하고
步履安詳 (보리안상) 하라,걸음걸이는 서두르지 말고 천천히 여유 있게 하라.
作事謀始 (작사모시) 하고,일을 할 때는 처음 시작부터 치밀하게 계획하고
出言顧行 (출언고행) 하라,말을 내뱉을 때는 내 행동이 따를 수 있는지 돌아보라.
常德固持 (상덕고지) 하고,변치 않는 덕성을 굳게 지켜 나가며
然諾重應 (연낙중응) 하라,한번 승낙한 약속은 천금같이 무겁게 지켜라.
飮食愼節 (음식신절) 하고,먹고 마시는 것은 절제하여 조심하고
言語恭遜 (언어공손) 하라,주고받는 말씨는 언제나 겸손하고 부드럽게 하라.
德業相勸 (덕업상권) 하고,좋은 일과 덕스러운 업은 서로 권장하며
過失相規 (과실상규) 하라,잘못과 실수는 서로 바로잡아 주며 깨우쳐 주라.
禮俗相交 (예속상교) 하고,예의 바른 풍속으로 서로 교류하며 지내고
患難相恤 (환난상휼) 하라,어렵고 힘든 일은 서로 가여워하며 도와주라.
貧窮困厄 (빈궁곤액) 엔,가난하고 곤궁하여 처지가 딱할 때에는
親戚相救 (친척상구) 하며,"친척들이 앞장서서 서로를 구제해 주어야 하며,"
婚姻死喪 (혼인사상) 엔,결혼이나 장례 같은 집안의 큰일에는
相扶相助 (상부상조) 하라,이웃끼리 서로 힘을 보태고 도와야 한다.
修身齊家 (수신제가) 는,자신을 닦고 가정을 화목하게 가꾸는 것은
治國之本 (치국지본) 이요,"나라를 평화롭게 다스리는 근본이 되는 것이며,"
讀書勤儉 (독서근검) 은,끊임없이 책을 읽고 부지런히 아끼는 것은
起家之本 (기가지본) 이니라,집안을 일으켜 세우는 든든한 뿌리가 되느니라.
忠信慈祥 (충신자상) 하고,충실하고 신의가 있으며 따뜻하고 자상하며
溫良恭儉 (온량공검) 은,온유하고 어질며 공손하고 검소한 태도는
人之德行 (인지덕행) 에,사람이 갖추어야 할 훌륭한 덕목 중에서도
謙讓爲上 (겸양위상) 이니라,자신을 낮추고 양보하는 '겸양'이 으뜸이니라.
莫談他短 (막담타단) 하고,남의 단점을 함부로 들추어 말하지 말고
靡恃己長 (미시기장) 하라,나의 장점을 믿고 뽐내며 잘난 척하지 말라.
己所不欲 (기소불욕) 을,내가 하기 싫고 원하지 않는 일을
勿施於人 (물시어인) 하라,다른 사람에게도 억지로 시키지 말라.
積善之家 (적선지가) 는,선한 일을 꾸준히 쌓아가는 집안에는
必有餘慶 (필유여경) 이요,"반드시 대대로 넘치는 경사가 따를 것이나,"
不善之家 (불선지가) 는,선하지 못한 일을 일삼는 집안에는
必有餘殃 (필유여앙) 이니라,반드시 뒤에까지 미치는 재앙이 따르느니라.
損人利己 (손인이기) 면,남에게 손해를 끼쳐 나만 이롭게 하려 한다면
終是自害 (종시자해) 요,"그것은 결국 끝내 자신을 해치는 길이 될 것이요,"
禍福無門 (화복무문) 이라,재앙과 복은 들어오는 문이 따로 정해져 있지 않고
惟人所召 (유인소조) 니라,오직 사람이 스스로 불러들이는 것이니라.
嗟嗟小子 (차차소자) 들아,"아, 배움을 시작하는 어린 학생들이여!"
敬受此書 (경수차서) 하라,공경하는 마음으로 이 책의 가르침을 받들라.
非我言耄 (비아언모) 라,내가 늙어 망령되게 하는 말이 아니라
惟聖之謨 (유성지모) 니라,오직 옛 성현들께서 남기신 거룩한 가르침이니라.
`;

function parseData(raw, section) {
    const lines = raw.trim().split('\n');
    return lines.map(line => {
        const commaIndex = line.indexOf(',');
        if (commaIndex === -1) return null;

        const phrasePart = line.substring(0, commaIndex).trim();
        let translation = line.substring(commaIndex + 1).trim();

        // Remove surrounding quotes from translation if present
        if (translation.startsWith('"') && translation.endsWith('"')) {
            translation = translation.slice(1, -1);
        }

        const match = phrasePart.match(/^(.+)\s\((.+)\)\s*(.*)$/);

        let hanja = '';
        let reading = '';
        let suffix = '';

        if (match) {
            hanja = match[1].trim();
            reading = match[2].trim();
            suffix = match[3] ? match[3].trim() : '';
        } else {
            hanja = phrasePart;
        }

        const original_line = `${hanja}(${reading})${suffix ? suffix : ''}        ${translation}`;

        return {
            section: section,
            hanja: hanja,
            reading: reading,
            suffix: suffix,
            translation: translation,
            original_line: original_line
        };
    }).filter(item => item !== null);
}

try {
    const existingContent = fs.readFileSync(filePath, 'utf8');
    const dataContent = existingContent.substring(existingContent.indexOf('['), existingContent.lastIndexOf(']') + 1);
    let currentData = JSON.parse(dataContent);

    const items7_1 = parseData(rawData7_1, section7_1Title);
    const items7_2 = parseData(rawData7_2, section7_2Title);
    const items7_3 = parseData(rawData7_3, section7_3Title);

    currentData.push(...items7_1);
    currentData.push(...items7_2);
    currentData.push(...items7_3);

    const newContent = `const sajaSohakData = ${JSON.stringify(currentData, null, 4)};\n`;
    fs.writeFileSync(filePath, newContent, 'utf8');
    console.log(`Successfully appended ${items7_1.length + items7_2.length + items7_3.length} items to Saja Sohak data.`);

} catch (e) {
    console.error("Error updating file:", e);
}
